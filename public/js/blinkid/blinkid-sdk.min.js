/*! ****************************************************************************
Copyright (c) Microblink. All rights reserved.

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.
***************************************************************************** */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).BlinkIDSDK={})}(this,(function(e){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function t(e,t,i,n){return new(i||(i=Promise))((function(o,a){function r(e){try{A(n.next(e))}catch(e){a(e)}}function s(e){try{A(n.throw(e))}catch(e){a(e)}}function A(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,s)}A((n=n.apply(e,t||[])).next())}))}let i=0;class n{constructor(e){this.action=e,this.messageID=function(){const e=i;return i+=1,e}()}}class o extends n{constructor(e,t){super(o.action),this.wasmModuleName=e.wasmModuleName,this.licenseKey=e.licenseKey,this.userId=t,this.registerLoadCallback=null!==e.loadProgressCallback,this.allowHelloMessage=e.allowHelloMessage,this.engineLocation=e.engineLocation,this.wasmType=e.wasmType,this.numberOfWorkers=e.numberOfWorkers}}var a,r,s,A,c,I;o.action="init",function(e){e[e.Any=0]="Any",e[e.Recognizer=1]="Recognizer",e[e.RecognizerSettings=2]="RecognizerSettings",e[e.Callback=3]="Callback"}(a||(a={}));class d extends n{constructor(e,t){super(d.action),this.funcName=e,this.params=t}}d.action="invokeFunction";class l extends n{constructor(e,t){super(l.action),this.className=e,this.params=t}}l.action="createNewNativeObject";class N extends n{constructor(e,t,i){super(N.action),this.recognizerHandles=e,this.allowMultipleResults=t,this.registeredMetadataCallbacks=i}}N.action="createRecognizerRunner";class R extends n{constructor(e,t){super(R.action),this.recognizerHandles=e,this.allowMultipleResults=t}}R.action="reconfigureRecognizerRunner";class E extends n{constructor(){super(E.action)}}E.action="deleteRecognizerRunner";class S extends n{constructor(e,t,i){super(S.action),this.objectHandle=e,this.methodName=t,this.params=i}}S.action="invokeObject";class u extends n{constructor(e){super(u.action),this.frame=e}getTransferrables(){return[this.frame.imageData.data.buffer]}}u.action="processImage";class O extends n{constructor(e){super(O.action),this.hardReset=e}}O.action="resetRecognizers";class C{constructor(){this.onDebugText=!1,this.onDetectionFailed=!1,this.onQuadDetection=!1,this.onPointsDetection=!1,this.onFirstSideResult=!1,this.onGlare=!1}}class T extends n{constructor(e){super(T.action),this.registeredMetadataCallbacks=e}}T.action="registerMetadataCallbacks";class D extends n{constructor(e){super(D.action),this.detectionOnlyMode=e}}D.action="setDetectionOnly";class m extends n{constructor(e){super(m.action),this.callbackNonEmpty=e}}m.action="setClearTimeoutCallback";class h extends n{constructor(e){super(h.action),this.cameraPreviewMirrored=e}}function _(e,t){return i=>{const n=i;n.success?e():t(n.error)}}function g(e,t){return i=>{const n=i;n.success?e(i):t(n.error)}}h.action="setCameraPreviewMirrored",function(e){e[e.onDebugText=0]="onDebugText",e[e.onDetectionFailed=1]="onDetectionFailed",e[e.onQuadDetection=2]="onQuadDetection",e[e.onPointsDetection=3]="onPointsDetection",e[e.onFirstSideResult=4]="onFirstSideResult",e[e.clearTimeoutCallback=5]="clearTimeoutCallback",e[e.onGlare=6]="onGlare",e[e.recognizerCallback=7]="recognizerCallback"}(r||(r={})),e.WasmType=void 0,(s=e.WasmType||(e.WasmType={})).Basic="BASIC",s.Advanced="ADVANCED",s.AdvancedWithThreads="ADVANCED_WITH_THREADS";class L{constructor(e,t,i){this.wasmSDKWorker=e,this.objectHandle=i,this.recognizerName=t,this.callbacks=new Map}getRemoteObjectHandle(){return this.objectHandle}currentSettings(){return new Promise((e,t)=>{if(0>this.objectHandle)return void t("Invalid object handle: "+this.objectHandle);const i=new S(this.objectHandle,"currentSettings",[]),n=g(t=>{e(t.result)},t);this.wasmSDKWorker.postMessage(i,n)})}clearAllCallbacks(){this.callbacks.clear(),this.wasmSDKWorker.unregisterRecognizerCallbacks(this.objectHandle)}removeFunctions(e){this.clearAllCallbacks();const t=Object.keys(e);let i=!1;for(const n of t){const t=e[n];if("function"==typeof t){this.callbacks.set(n,t);e[n]={parameter:{recognizerHandle:this.objectHandle,callbackName:n},type:a.Callback},i=!0}}return i&&this.wasmSDKWorker.registerRecognizerCallbacks(this.objectHandle,this),e}updateSettings(e){return new Promise((t,i)=>{if(0>this.objectHandle)return void i("Invalid object handle: "+this.objectHandle);const n=new S(this.objectHandle,"updateSettings",[{parameter:this.removeFunctions(e),type:a.RecognizerSettings}]),o=_(t,i);this.wasmSDKWorker.postMessage(n,o)})}invokeCallback(e,t){const i=this.callbacks.get(e);void 0!==i?i(...t):console.warn("Cannot find callback",e)}getResult(){return new Promise((e,t)=>{if(0>this.objectHandle)return void t("Invalid object handle: "+this.objectHandle);const i=new S(this.objectHandle,"getResult",[]),n=g(t=>{e(t.result)},t);this.wasmSDKWorker.postMessage(i,n)})}delete(){return new Promise((e,t)=>{if(0>this.objectHandle)return void t("Invalid object handle: "+this.objectHandle);this.clearAllCallbacks();const i=new S(this.objectHandle,"delete",[]),n=_(()=>{this.objectHandle=-1,e()},t);this.wasmSDKWorker.postMessage(i,n)})}}function M(e){const t=new C;return t.onDebugText=!!e.onDebugText,t.onDetectionFailed=!!e.onDetectionFailed,t.onPointsDetection=!!e.onPointsDetection,t.onQuadDetection=!!e.onQuadDetection,t.onFirstSideResult=!!e.onFirstSideResult,t.onGlare=!!e.onGlare,t}class U{constructor(e){this.deleted=!1,this.wasmSDKWorker=e}processImage(e){return new Promise((t,i)=>{if(this.deleted)return void i("Recognizer runner is deleted. It cannot be used anymore!");const n=new u(e),o=g(e=>{t(e.recognitionState)},i);this.wasmSDKWorker.postTransferrableMessage(n,o)})}reconfigureRecognizers(e,t){return new Promise((i,n)=>{if(this.deleted)return void n("Recognizer runner is deleted. It cannot be used anymore!");const o=p(e),a=new R(o,t),r=_(i,n);this.wasmSDKWorker.postMessage(a,r)})}setMetadataCallbacks(e){return new Promise((t,i)=>{const n=new T(M(e)),o=_(t,i);this.wasmSDKWorker.postMessageAndRegisterCallbacks(n,e,o)})}resetRecognizers(e){return new Promise((t,i)=>{const n=new O(e),o=_(t,i);this.wasmSDKWorker.postMessage(n,o)})}setDetectionOnlyMode(e){return new Promise((t,i)=>{const n=new D(e),o=_(t,i);this.wasmSDKWorker.postMessage(n,o)})}setClearTimeoutCallback(e){return new Promise((t,i)=>{const n=new m(null!==e),o=_(t,i);this.wasmSDKWorker.registerClearTimeoutCallback(e),this.wasmSDKWorker.postMessage(n,o)})}setCameraPreviewMirrored(e){return new Promise((t,i)=>{const n=new h(e),o=_(t,i);this.wasmSDKWorker.postMessage(n,o)})}delete(){return this.deleted?Promise.reject("Recognizer runner is already deleted."):new Promise((e,t)=>{const i=new E,n=_(()=>{this.deleted=!0,e()},t);this.wasmSDKWorker.postMessage(i,n)})}}function p(e){const t=[];for(const i of e)t.push(i.getRemoteObjectHandle());return t}class P{constructor(e){this.wasmSDKWorker=e}createRecognizerRunner(e,t=!1,i={}){return new Promise((n,o)=>{const a=p(e),r=new N(a,t,M(i)),s=_(()=>{n(new U(this.wasmSDKWorker))},o);this.wasmSDKWorker.postMessageAndRegisterCallbacks(r,i,s)})}newRecognizer(e,...t){return new Promise((i,n)=>{const o=new l(e,function(e){const t=[];for(let i of e){let e=a.Any;i instanceof L&&(e=a.Recognizer,i=i.getRemoteObjectHandle()),t.push({parameter:i,type:e})}return t}(t)),r=g(t=>{const n=new L(this.wasmSDKWorker,e,t.objectHandle);i(n)},n);this.wasmSDKWorker.postMessage(o,r)})}}class b{constructor(t,i,n){this.eventHandlers={},this.metadataCallbacks={},this.clearTimeoutCallback=null,this.loadedWasmType=e.WasmType.Basic,this.mbWasmWorker=t,this.mbWasmWorker.onmessage=e=>{this.handleWorkerEvent(e)},this.mbWasmWorker.onerror=()=>{n("Problem during initialization of worker file!")},this.mbWasmModule=new P(this),this.loadCallback=i,this.recognizersWithCallbacks=new Map,this.showOverlay=!1}postMessage(e,t){this.eventHandlers[e.messageID]=t,this.mbWasmWorker.postMessage(e)}postTransferrableMessage(e,t){this.eventHandlers[e.messageID]=t,this.mbWasmWorker.postMessage(e,e.getTransferrables())}postMessageAndRegisterCallbacks(e,t,i){this.eventHandlers[e.messageID]=i,this.metadataCallbacks=t,this.mbWasmWorker.postMessage(e)}registerClearTimeoutCallback(e){this.clearTimeoutCallback=e}registerRecognizerCallbacks(e,t){this.recognizersWithCallbacks.set(e,t)}unregisterRecognizerCallbacks(e){this.recognizersWithCallbacks.delete(e)}delete(){this.mbWasmWorker.terminate()}handleWorkerEvent(e){if("isCallbackMessage"in e.data){const t=e.data;switch(t.callbackType){case r.onDebugText:"function"==typeof this.metadataCallbacks.onDebugText&&this.metadataCallbacks.onDebugText(t.callbackParameters[0]);break;case r.onDetectionFailed:"function"==typeof this.metadataCallbacks.onDetectionFailed&&this.metadataCallbacks.onDetectionFailed();break;case r.onPointsDetection:"function"==typeof this.metadataCallbacks.onPointsDetection&&this.metadataCallbacks.onPointsDetection(t.callbackParameters[0]);break;case r.onQuadDetection:"function"==typeof this.metadataCallbacks.onQuadDetection&&this.metadataCallbacks.onQuadDetection(t.callbackParameters[0]);break;case r.onFirstSideResult:"function"==typeof this.metadataCallbacks.onFirstSideResult&&this.metadataCallbacks.onFirstSideResult();break;case r.clearTimeoutCallback:this.clearTimeoutCallback&&"function"==typeof this.clearTimeoutCallback.onClearTimeout&&this.clearTimeoutCallback.onClearTimeout();break;case r.onGlare:"function"==typeof this.metadataCallbacks.onGlare&&this.metadataCallbacks.onGlare(t.callbackParameters[0]);break;case r.recognizerCallback:{const e=t.callbackParameters.shift(),i=this.recognizersWithCallbacks.get(e.recognizerHandle);void 0!==i?i.invokeCallback(e.callbackName,t.callbackParameters):console.warn("Cannot find recognizer to deliver callback message. Maybe it's destroyed?",e);break}default:throw Error("Unknown callback type: "+r[t.callbackType])}}else if("isLoadProgressMessage"in e.data){const t=e.data;"function"==typeof this.loadCallback&&this.loadCallback(t.progress)}else{const t=e.data,i=this.eventHandlers[t.messageID];delete this.eventHandlers[t.messageID],i(t)}}static createWasmWorker(e,i,n){return t(this,void 0,void 0,(function*(){return new Promise((t,a)=>{const r=new b(e,i.loadProgressCallback,a),s=new o(i,n),A=g(e=>{const i=e;r.showOverlay=i.showOverlay,r.loadedWasmType=i.wasmType,t(r)},e=>{r&&"function"==typeof r.delete&&r.delete(),a(e)});r.postMessage(s,A)})}))}}let f;e.ImageOrientation=void 0,(A=e.ImageOrientation||(e.ImageOrientation={}))[A.RotatedLeft90=0]="RotatedLeft90",A[A.NoRotation=1]="NoRotation",A[A.RotatedRight90=2]="RotatedRight90",A[A.Rotated180=3]="Rotated180",e.RecognizerResultState=void 0,(c=e.RecognizerResultState||(e.RecognizerResultState={}))[c.Empty=0]="Empty",c[c.Uncertain=1]="Uncertain",c[c.Valid=2]="Valid",c[c.StageValid=3]="StageValid",e.DetectionStatus=void 0,(I=e.DetectionStatus||(e.DetectionStatus={}))[I.Fail=0]="Fail",I[I.Success=1]="Success",I[I.CameraTooHigh=2]="CameraTooHigh",I[I.FallbackSuccess=3]="FallbackSuccess",I[I.Partial=4]="Partial",I[I.CameraAtAngle=5]="CameraAtAngle",I[I.CameraTooNear=6]="CameraTooNear",I[I.DocumentTooCloseToEdge=7]="DocumentTooCloseToEdge";class H{constructor(e,t,i){this.imageData=e,this.orientation=t,this.videoFrame=i}}function F(t){let i,n,o=!1;if(t instanceof HTMLVideoElement)i=t.videoWidth,n=t.videoHeight,o=!0;else if(t instanceof HTMLImageElement)i=t.naturalWidth,n=t.naturalHeight;else{if(t instanceof SVGImageElement)throw Error("Recognition of SVG elements not supported!");i=t.width,n=t.height}f=f||document.createElement("canvas"),f.width=i,f.height=n;const a=f.getContext("2d");if(!a)throw Error("Could not get canvas 2d context!");a.drawImage(t,0,0,f.width,f.height);const r=a.getImageData(0,0,f.width,f.height);return new H(r,e.ImageOrientation.NoRotation,o)}var v,y,B;e.PreferredCameraType=void 0,(v=e.PreferredCameraType||(e.PreferredCameraType={}))[v.BackFacingCamera=0]="BackFacingCamera",v[v.FrontFacingCamera=1]="FrontFacingCamera",e.NotSupportedReason=void 0,(y=e.NotSupportedReason||(e.NotSupportedReason={})).MediaDevicesNotSupported="MediaDevicesNotSupported",y.CameraNotFound="CameraNotFound",y.CameraNotAllowed="CameraNotAllowed",y.CameraInUse="CameraInUse",y.CameraNotAvailable="CameraNotAvailable",y.VideoElementNotProvided="VideoElementNotProvided";class W extends Error{constructor(e,...t){super(...t),this.reason=e,this.name="VideoRecognizerError"}}e.VideoRecognitionMode=void 0,(B=e.VideoRecognitionMode||(e.VideoRecognitionMode={}))[B.Recognition=0]="Recognition",B[B.RecognitionTest=1]="RecognitionTest",B[B.DetectionTest=2]="DetectionTest";class G{constructor(t,i,n=!1,o=!1){this.videoFeed=null,this.cancelled=!1,this.timedOut=!1,this.recognitionPaused=!1,this.recognitionTimeoutMs=15e3,this.timeoutID=0,this.videoRecognitionMode=e.VideoRecognitionMode.Recognition,this.onScanningDone=null,this.allowManualVideoPlayout=!1,this.cameraFlipped=!1,this.videoFeed=t,this.recognizerRunner=i,this.cameraFlipped=n,this.allowManualVideoPlayout=o}static createVideoRecognizerFromCameraStream(i,n,o=null,a=e.PreferredCameraType.BackFacingCamera){return t(this,void 0,void 0,(function*(){return new Promise((r,s)=>t(this,void 0,void 0,(function*(){if(i&&i instanceof Element)if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)try{const A=yield function(i,n){return t(this,void 0,void 0,(function*(){const t=[],o=[];{let i=yield navigator.mediaDevices.enumerateDevices();if(i.filter(e=>"videoinput"===e.kind).every(e=>""===e.label)){const e=yield navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1});i=yield navigator.mediaDevices.enumerateDevices(),e.getTracks().forEach(e=>e.stop())}const n=i.filter(e=>"videoinput"===e.kind);for(const i of n)w(i.label)?o.push(new K(i,e.PreferredCameraType.BackFacingCamera)):t.push(new K(i,e.PreferredCameraType.FrontFacingCamera))}if(t.length>0||o.length>0){let a=o.length>0?o:t;n===e.PreferredCameraType.BackFacingCamera&&o.length>0&&(a=o),n===e.PreferredCameraType.FrontFacingCamera&&t.length>0&&(a=t),a=a.sort((e,t)=>e.label.localeCompare(t.label));{let e=0;const n=a.map(e=>{const t=/\b([0-9]+)MP?\b/i.exec(e.label);return null!==t?parseInt(t[1],10):NaN});if(n.some(e=>isNaN(e))||(e=n.lastIndexOf(Math.max(...n))),i){let e=null;return e=t.filter(e=>e.deviceId===i)[0],e||(e=o.filter(e=>e.deviceId===i)[0]),e||null}return a[e]}}return null}))}(o,a);if(null===A)return void s(new W(e.NotSupportedReason.CameraNotFound));const c={audio:!1,video:{width:{min:640,ideal:1920,max:1920},height:{min:480,ideal:1080,max:1080}}};if(""===A.deviceId){c.video.facingMode={ideal:a===e.PreferredCameraType.BackFacingCamera?"environment":"user"}}else c.video.deviceId={exact:A.deviceId};const I=yield navigator.mediaDevices.getUserMedia(c);i.controls=!1,i.srcObject=I;let d=!1;A.facing===e.PreferredCameraType.FrontFacingCamera&&(i.style.transform="scaleX(-1)",d=!0),yield n.setCameraPreviewMirrored(d),r(new G(i,n,d))}catch(t){let i=e.NotSupportedReason.CameraInUse;switch(t.name){case"NotFoundError":case"OverconstrainedError":i=e.NotSupportedReason.CameraNotFound;break;case"NotAllowedError":case"SecurityError":i=e.NotSupportedReason.CameraNotAllowed;break;case"AbortError":case"NotReadableError":i=e.NotSupportedReason.CameraNotAvailable;break;case"TypeError":throw t}s(new W(i,t.message))}else s(new W(e.NotSupportedReason.MediaDevicesNotSupported));else{s(new W(e.NotSupportedReason.VideoElementNotProvided,"Video element, i.e. camera feed is not provided!"))}})))}))}static createVideoRecognizerFromVideoPath(e,i,n){return t(this,void 0,void 0,(function*(){return new Promise(t=>{i.src=e,i.currentTime=0,i.onended=()=>{o.cancelRecognition()};const o=new G(i,n);t(o)})}))}flipCamera(){return t(this,void 0,void 0,(function*(){this.videoFeed&&(this.cameraFlipped?(this.videoFeed.style.transform="scaleX(1)",this.cameraFlipped=!1):(this.videoFeed.style.transform="scaleX(-1)",this.cameraFlipped=!0),yield this.recognizerRunner.setCameraPreviewMirrored(this.cameraFlipped))}))}setVideoRecognitionMode(i){return t(this,void 0,void 0,(function*(){this.videoRecognitionMode=i;const t=this.videoRecognitionMode===e.VideoRecognitionMode.DetectionTest;yield this.recognizerRunner.setDetectionOnlyMode(t)}))}startRecognition(e,t=15e3){return new Promise((i,n)=>{null!==this.videoFeed?this.videoFeed.paused?(this.cancelled=!1,this.recognitionPaused=!1,this.clearTimeout(),this.recognitionTimeoutMs=t,this.onScanningDone=e,this.recognizerRunner.setClearTimeoutCallback({onClearTimeout:()=>this.clearTimeout()}),this.videoFeed.play().then(()=>this.playPauseEvent().then(()=>i()).catch(e=>n(e)),e=>{if(!this.allowManualVideoPlayout)return console.warn("Native error",e),void n(Error("The play() request was interrupted or prevented by browser security rules!"));this.videoFeed&&(this.videoFeed.controls=!0,this.videoFeed.addEventListener("play",()=>{this.playPauseEvent().then().catch(e=>n(e))}),this.videoFeed.addEventListener("pause",()=>{this.playPauseEvent().then().catch(e=>n(e))}))})):n(Error("The associated video feed is not paused. Use resumeRecognition instead!")):n(Error("The associated video feed has been released!"))})}recognize(e=15e3){return new Promise((t,i)=>{try{this.startRecognition(e=>{this.pauseVideoFeed(),t(e)},e).then().catch(e=>i(e))}catch(e){i(e)}})}cancelRecognition(){this.cancelled=!0}pauseVideoFeed(){this.pauseRecognition(),this.videoFeed&&this.videoFeed.pause()}pauseRecognition(){this.recognitionPaused=!0}resetRecognizers(e){return t(this,void 0,void 0,(function*(){yield this.recognizerRunner.resetRecognizers(e)}))}getRecognizerRunner(){return this.recognizerRunner}resumeRecognition(e){return new Promise((t,i)=>{if(this.cancelled=!1,this.timedOut=!1,this.recognitionPaused=!1,this.videoFeed&&this.videoFeed.paused){i(Error("Cannot resume recognition while video feed is paused! Use recognize or startRecognition"))}else setTimeout(()=>{e?this.resetRecognizers(!0).then(()=>{this.recognitionLoop().then(()=>t()).catch(e=>i(e))}).catch(()=>{i(Error("Could not reset recognizers!"))}):this.recognitionLoop().then(()=>t()).catch(e=>i(e))},1)})}releaseVideoFeed(){null!==this.videoFeed&&(null!==this.videoFeed.srcObject&&(this.videoFeed.paused||this.cancelRecognition(),this.videoFeed.srcObject.getTracks().forEach(e=>e.stop()),this.videoFeed.srcObject=null),this.videoFeed=null)}playPauseEvent(){return new Promise((e,t)=>{if(this.videoFeed&&this.videoFeed.paused)return this.cancelRecognition(),void e();this.resumeRecognition(!0).then(()=>e()).catch(e=>t(e))})}recognitionLoop(){return new Promise((t,i)=>{if(!this.videoFeed)return void i(Error("Missing video feed!"));const n=F(this.videoFeed);this.recognizerRunner.processImage(n).then(n=>{const o=()=>{this.recognitionPaused?t():setTimeout(()=>{this.recognitionLoop().then(()=>t()).catch(e=>i(e))},1)};if(n===e.RecognizerResultState.Valid||this.cancelled||this.timedOut){if(this.videoRecognitionMode!==e.VideoRecognitionMode.Recognition&&!this.cancelled)return void this.recognizerRunner.resetRecognizers(!0).then(()=>{this.clearTimeout(),o()}).catch(e=>i(e));this.clearTimeout(),this.onScanningDone&&this.onScanningDone(n)}else{if(n===e.RecognizerResultState.Uncertain)return 0===this.timeoutID&&(this.timeoutID=window.setTimeout(()=>{this.timedOut=!0},this.recognitionTimeoutMs)),void o();if(n===e.RecognizerResultState.StageValid)return this.clearTimeout(),void o()}o()}).catch(e=>i(e))})}clearTimeout(){this.timeoutID>0&&(window.clearTimeout(this.timeoutID),this.timeoutID=0)}}const k=["rear","back","rück","arrière","trasera","trás","traseira","posteriore","后面","後面","背面","后置","後置","背置","задней","الخلفية","후","arka","achterzijde","หลัง","baksidan","bagside","sau","bak","tylny","takakamera","belakang","אחורית","πίσω","spate","hátsó","zadní","darrere","zadná","задня","stražnja","belakang","बैक"];function w(e){const t=e.toLowerCase();return k.some(e=>t.includes(e))}class K{constructor(e,t){this.deviceId=e.deviceId,this.facing=t,this.groupId=e.groupId,this.label=e.label}}function V(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}var Y,z,x,J,j,Z,Q,X,q,$,ee;e.BarcodeFormat=void 0,(Y=e.BarcodeFormat||(e.BarcodeFormat={}))[Y.NONE=0]="NONE",Y[Y.QR_CODE=1]="QR_CODE",Y[Y.DATA_MATRIX=2]="DATA_MATRIX",Y[Y.UPC_E=3]="UPC_E",Y[Y.UPC_A=4]="UPC_A",Y[Y.EAN_8=5]="EAN_8",Y[Y.EAN_13=6]="EAN_13",Y[Y.CODE_128=7]="CODE_128",Y[Y.CODE_39=8]="CODE_39",Y[Y.ITF=9]="ITF",Y[Y.AZTEC_BARCODE=10]="AZTEC_BARCODE",Y[Y.PDF417_BARCODE=11]="PDF417_BARCODE",e.AnonymizationMode=void 0,(z=e.AnonymizationMode||(e.AnonymizationMode={}))[z.None=0]="None",z[z.ImageOnly=1]="ImageOnly",z[z.ResultFieldsOnly=2]="ResultFieldsOnly",z[z.FullResult=3]="FullResult";class te{constructor(e=0,t=0,i=0,n=0){this.upFactor=0,this.downFactor=0,this.leftFactor=0,this.rightFactor=0,this.checkExtensionFactor(e),this.checkExtensionFactor(t),this.checkExtensionFactor(i),this.checkExtensionFactor(n),this.upFactor=e,this.downFactor=t,this.leftFactor=i,this.rightFactor=n}checkExtensionFactor(e){if(e>1||-1>e)throw Error("Extension factor must be in range [-1.0, 1.0]")}}function ie(e){if(100>e||e>400)throw Error("DPI must be from interval [100, 400]")}e.BarcodeElementKey=void 0,(x=e.BarcodeElementKey||(e.BarcodeElementKey={}))[x.DocumentType=0]="DocumentType",x[x.StandardVersionNumber=1]="StandardVersionNumber",x[x.CustomerFamilyName=2]="CustomerFamilyName",x[x.CustomerFirstName=3]="CustomerFirstName",x[x.CustomerFullName=4]="CustomerFullName",x[x.DateOfBirth=5]="DateOfBirth",x[x.Sex=6]="Sex",x[x.EyeColor=7]="EyeColor",x[x.AddressStreet=8]="AddressStreet",x[x.AddressCity=9]="AddressCity",x[x.AddressJurisdictionCode=10]="AddressJurisdictionCode",x[x.AddressPostalCode=11]="AddressPostalCode",x[x.FullAddress=12]="FullAddress",x[x.Height=13]="Height",x[x.HeightIn=14]="HeightIn",x[x.HeightCm=15]="HeightCm",x[x.CustomerMiddleName=16]="CustomerMiddleName",x[x.HairColor=17]="HairColor",x[x.NameSuffix=18]="NameSuffix",x[x.AKAFullName=19]="AKAFullName",x[x.AKAFamilyName=20]="AKAFamilyName",x[x.AKAGivenName=21]="AKAGivenName",x[x.AKASuffixName=22]="AKASuffixName",x[x.WeightRange=23]="WeightRange",x[x.WeightPounds=24]="WeightPounds",x[x.WeightKilograms=25]="WeightKilograms",x[x.CustomerIdNumber=26]="CustomerIdNumber",x[x.FamilyNameTruncation=27]="FamilyNameTruncation",x[x.FirstNameTruncation=28]="FirstNameTruncation",x[x.MiddleNameTruncation=29]="MiddleNameTruncation",x[x.PlaceOfBirth=30]="PlaceOfBirth",x[x.AddressStreet2=31]="AddressStreet2",x[x.RaceEthnicity=32]="RaceEthnicity",x[x.NamePrefix=33]="NamePrefix",x[x.CountryIdentification=34]="CountryIdentification",x[x.ResidenceStreetAddress=35]="ResidenceStreetAddress",x[x.ResidenceStreetAddress2=36]="ResidenceStreetAddress2",x[x.ResidenceCity=37]="ResidenceCity",x[x.ResidenceJurisdictionCode=38]="ResidenceJurisdictionCode",x[x.ResidencePostalCode=39]="ResidencePostalCode",x[x.ResidenceFullAddress=40]="ResidenceFullAddress",x[x.Under18=41]="Under18",x[x.Under19=42]="Under19",x[x.Under21=43]="Under21",x[x.SocialSecurityNumber=44]="SocialSecurityNumber",x[x.AKASocialSecurityNumber=45]="AKASocialSecurityNumber",x[x.AKAMiddleName=46]="AKAMiddleName",x[x.AKAPrefixName=47]="AKAPrefixName",x[x.OrganDonor=48]="OrganDonor",x[x.Veteran=49]="Veteran",x[x.AKADateOfBirth=50]="AKADateOfBirth",x[x.IssuerIdentificationNumber=51]="IssuerIdentificationNumber",x[x.DocumentExpirationDate=52]="DocumentExpirationDate",x[x.JurisdictionVersionNumber=53]="JurisdictionVersionNumber",x[x.JurisdictionVehicleClass=54]="JurisdictionVehicleClass",x[x.JurisdictionRestrictionCodes=55]="JurisdictionRestrictionCodes",x[x.JurisdictionEndorsementCodes=56]="JurisdictionEndorsementCodes",x[x.DocumentIssueDate=57]="DocumentIssueDate",x[x.FederalCommercialVehicleCodes=58]="FederalCommercialVehicleCodes",x[x.IssuingJurisdiction=59]="IssuingJurisdiction",x[x.StandardVehicleClassification=60]="StandardVehicleClassification",x[x.IssuingJurisdictionName=61]="IssuingJurisdictionName",x[x.StandardEndorsementCode=62]="StandardEndorsementCode",x[x.StandardRestrictionCode=63]="StandardRestrictionCode",x[x.JurisdictionVehicleClassificationDescription=64]="JurisdictionVehicleClassificationDescription",x[x.JurisdictionEndorsmentCodeDescription=65]="JurisdictionEndorsmentCodeDescription",x[x.JurisdictionRestrictionCodeDescription=66]="JurisdictionRestrictionCodeDescription",x[x.InventoryControlNumber=67]="InventoryControlNumber",x[x.CardRevisionDate=68]="CardRevisionDate",x[x.DocumentDiscriminator=69]="DocumentDiscriminator",x[x.LimitedDurationDocument=70]="LimitedDurationDocument",x[x.AuditInformation=71]="AuditInformation",x[x.ComplianceType=72]="ComplianceType",x[x.IssueTimestamp=73]="IssueTimestamp",x[x.PermitExpirationDate=74]="PermitExpirationDate",x[x.PermitIdentifier=75]="PermitIdentifier",x[x.PermitIssueDate=76]="PermitIssueDate",x[x.NumberOfDuplicates=77]="NumberOfDuplicates",x[x.HAZMATExpirationDate=78]="HAZMATExpirationDate",x[x.MedicalIndicator=79]="MedicalIndicator",x[x.NonResident=80]="NonResident",x[x.UniqueCustomerId=81]="UniqueCustomerId",x[x.DataDiscriminator=82]="DataDiscriminator",x[x.DocumentExpirationMonth=83]="DocumentExpirationMonth",x[x.DocumentNonexpiring=84]="DocumentNonexpiring",x[x.SecurityVersion=85]="SecurityVersion",x[x.Count=86]="Count",e.Country=void 0,(J=e.Country||(e.Country={}))[J.NONE=0]="NONE",J[J.ALBANIA=1]="ALBANIA",J[J.ALGERIA=2]="ALGERIA",J[J.ARGENTINA=3]="ARGENTINA",J[J.AUSTRALIA=4]="AUSTRALIA",J[J.AUSTRIA=5]="AUSTRIA",J[J.AZERBAIJAN=6]="AZERBAIJAN",J[J.BAHRAIN=7]="BAHRAIN",J[J.BANGLADESH=8]="BANGLADESH",J[J.BELGIUM=9]="BELGIUM",J[J.BOSNIA_AND_HERZEGOVINA=10]="BOSNIA_AND_HERZEGOVINA",J[J.BRUNEI=11]="BRUNEI",J[J.BULGARIA=12]="BULGARIA",J[J.CAMBODIA=13]="CAMBODIA",J[J.CANADA=14]="CANADA",J[J.CHILE=15]="CHILE",J[J.COLOMBIA=16]="COLOMBIA",J[J.COSTA_RICA=17]="COSTA_RICA",J[J.CROATIA=18]="CROATIA",J[J.CYPRUS=19]="CYPRUS",J[J.CZECHIA=20]="CZECHIA",J[J.DENMARK=21]="DENMARK",J[J.DOMINICAN_REPUBLIC=22]="DOMINICAN_REPUBLIC",J[J.EGYPT=23]="EGYPT",J[J.ESTONIA=24]="ESTONIA",J[J.FINLAND=25]="FINLAND",J[J.FRANCE=26]="FRANCE",J[J.GEORGIA=27]="GEORGIA",J[J.GERMANY=28]="GERMANY",J[J.GHANA=29]="GHANA",J[J.GREECE=30]="GREECE",J[J.GUATEMALA=31]="GUATEMALA",J[J.HONG_KONG=32]="HONG_KONG",J[J.HUNGARY=33]="HUNGARY",J[J.INDIA=34]="INDIA",J[J.INDONESIA=35]="INDONESIA",J[J.IRELAND=36]="IRELAND",J[J.ISRAEL=37]="ISRAEL",J[J.ITALY=38]="ITALY",J[J.JORDAN=39]="JORDAN",J[J.KAZAKHSTAN=40]="KAZAKHSTAN",J[J.KENYA=41]="KENYA",J[J.KOSOVO=42]="KOSOVO",J[J.KUWAIT=43]="KUWAIT",J[J.LATVIA=44]="LATVIA",J[J.LITHUANIA=45]="LITHUANIA",J[J.MALAYSIA=46]="MALAYSIA",J[J.MALDIVES=47]="MALDIVES",J[J.MALTA=48]="MALTA",J[J.MAURITIUS=49]="MAURITIUS",J[J.MEXICO=50]="MEXICO",J[J.MOROCCO=51]="MOROCCO",J[J.NETHERLANDS=52]="NETHERLANDS",J[J.NEW_ZEALAND=53]="NEW_ZEALAND",J[J.NIGERIA=54]="NIGERIA",J[J.PAKISTAN=55]="PAKISTAN",J[J.PANAMA=56]="PANAMA",J[J.PARAGUAY=57]="PARAGUAY",J[J.PHILIPPINES=58]="PHILIPPINES",J[J.POLAND=59]="POLAND",J[J.PORTUGAL=60]="PORTUGAL",J[J.PUERTO_RICO=61]="PUERTO_RICO",J[J.QATAR=62]="QATAR",J[J.ROMANIA=63]="ROMANIA",J[J.RUSSIA=64]="RUSSIA",J[J.SAUDI_ARABIA=65]="SAUDI_ARABIA",J[J.SERBIA=66]="SERBIA",J[J.SINGAPORE=67]="SINGAPORE",J[J.SLOVAKIA=68]="SLOVAKIA",J[J.SLOVENIA=69]="SLOVENIA",J[J.SOUTH_AFRICA=70]="SOUTH_AFRICA",J[J.SPAIN=71]="SPAIN",J[J.SWEDEN=72]="SWEDEN",J[J.SWITZERLAND=73]="SWITZERLAND",J[J.TAIWAN=74]="TAIWAN",J[J.THAILAND=75]="THAILAND",J[J.TUNISIA=76]="TUNISIA",J[J.TURKEY=77]="TURKEY",J[J.UAE=78]="UAE",J[J.UGANDA=79]="UGANDA",J[J.UK=80]="UK",J[J.UKRAINE=81]="UKRAINE",J[J.USA=82]="USA",J[J.VIETNAM=83]="VIETNAM",J[J.BRAZIL=84]="BRAZIL",J[J.NORWAY=85]="NORWAY",J[J.OMAN=86]="OMAN",J[J.ECUADOR=87]="ECUADOR",J[J.EL_SALVADOR=88]="EL_SALVADOR",J[J.SRI_LANKA=89]="SRI_LANKA",J[J.PERU=90]="PERU",J[J.URUGUAY=91]="URUGUAY",J[J.BAHAMAS=92]="BAHAMAS",J[J.BERMUDA=93]="BERMUDA",J[J.BOLIVIA=94]="BOLIVIA",J[J.CHINA=95]="CHINA",J[J.EUROPEAN_UNION=96]="EUROPEAN_UNION",J[J.HAITI=97]="HAITI",J[J.HONDURAS=98]="HONDURAS",J[J.ICELAND=99]="ICELAND",J[J.JAPAN=100]="JAPAN",J[J.LUXEMBOURG=101]="LUXEMBOURG",J[J.MONTENEGRO=102]="MONTENEGRO",J[J.NICARAGUA=103]="NICARAGUA",J[J.SOUTH_KOREA=104]="SOUTH_KOREA",J[J.VENEZUELA=105]="VENEZUELA",J[J.AFGHANISTAN=106]="AFGHANISTAN",J[J.ALAND_ISLANDS=107]="ALAND_ISLANDS",J[J.AMERICAN_SAMOA=108]="AMERICAN_SAMOA",J[J.ANDORRA=109]="ANDORRA",J[J.ANGOLA=110]="ANGOLA",J[J.ANGUILLA=111]="ANGUILLA",J[J.ANTARCTICA=112]="ANTARCTICA",J[J.ANTIGUA_AND_BARBUDA=113]="ANTIGUA_AND_BARBUDA",J[J.ARMENIA=114]="ARMENIA",J[J.ARUBA=115]="ARUBA",J[J.BAILIWICK_OF_GUERNSEY=116]="BAILIWICK_OF_GUERNSEY",J[J.BAILIWICK_OF_JERSEY=117]="BAILIWICK_OF_JERSEY",J[J.BARBADOS=118]="BARBADOS",J[J.BELARUS=119]="BELARUS",J[J.BELIZE=120]="BELIZE",J[J.BENIN=121]="BENIN",J[J.BHUTAN=122]="BHUTAN",J[J.BONAIRE_SAINT_EUSTATIUS_AND_SABA=123]="BONAIRE_SAINT_EUSTATIUS_AND_SABA",J[J.BOTSWANA=124]="BOTSWANA",J[J.BOUVET_ISLAND=125]="BOUVET_ISLAND",J[J.BRITISH_INDIAN_OCEAN_TERRITORY=126]="BRITISH_INDIAN_OCEAN_TERRITORY",J[J.BURKINA_FASO=127]="BURKINA_FASO",J[J.BURUNDI=128]="BURUNDI",J[J.CAMEROON=129]="CAMEROON",J[J.CAPE_VERDE=130]="CAPE_VERDE",J[J.CARIBBEAN_NETHERLANDS=131]="CARIBBEAN_NETHERLANDS",J[J.CAYMAN_ISLANDS=132]="CAYMAN_ISLANDS",J[J.CENTRAL_AFRICAN_REPUBLIC=133]="CENTRAL_AFRICAN_REPUBLIC",J[J.CHAD=134]="CHAD",J[J.CHRISTMAS_ISLAND=135]="CHRISTMAS_ISLAND",J[J.COCOS_ISLANDS=136]="COCOS_ISLANDS",J[J.COMOROS=137]="COMOROS",J[J.CONGO=138]="CONGO",J[J.COOK_ISLANDS=139]="COOK_ISLANDS",J[J.CUBA=140]="CUBA",J[J.CURACAO=141]="CURACAO",J[J.DEMOCRATIC_REPUBLIC_OF_THE_CONGO=142]="DEMOCRATIC_REPUBLIC_OF_THE_CONGO",J[J.DJIBOUTI=143]="DJIBOUTI",J[J.DOMINICA=144]="DOMINICA",J[J.EAST_TIMOR=145]="EAST_TIMOR",J[J.EQUATORIAL_GUINEA=146]="EQUATORIAL_GUINEA",J[J.ERITREA=147]="ERITREA",J[J.ETHIOPIA=148]="ETHIOPIA",J[J.FALKLAND_ISLANDS=149]="FALKLAND_ISLANDS",J[J.FAROE_ISLANDS=150]="FAROE_ISLANDS",J[J.FEDERATED_STATES_OF_MICRONESIA=151]="FEDERATED_STATES_OF_MICRONESIA",J[J.FIJI=152]="FIJI",J[J.FRENCH_GUIANA=153]="FRENCH_GUIANA",J[J.FRENCH_POLYNESIA=154]="FRENCH_POLYNESIA",J[J.FRENCH_SOUTHERN_TERRITORIES=155]="FRENCH_SOUTHERN_TERRITORIES",J[J.GABON=156]="GABON",J[J.GAMBIA=157]="GAMBIA",J[J.GIBRALTAR=158]="GIBRALTAR",J[J.GREENLAND=159]="GREENLAND",J[J.GRENADA=160]="GRENADA",J[J.GUADELOUPE=161]="GUADELOUPE",J[J.GUAM=162]="GUAM",J[J.GUINEA=163]="GUINEA",J[J.GUINEA_BISSAU=164]="GUINEA_BISSAU",J[J.GUYANA=165]="GUYANA",J[J.HEARD_ISLAND_AND_MCDONALD_ISLANDS=166]="HEARD_ISLAND_AND_MCDONALD_ISLANDS",J[J.IRAN=167]="IRAN",J[J.IRAQ=168]="IRAQ",J[J.ISLE_OF_MAN=169]="ISLE_OF_MAN",J[J.IVORY_COAST=170]="IVORY_COAST",J[J.JAMAICA=171]="JAMAICA",J[J.KIRIBATI=172]="KIRIBATI",J[J.KYRGYZSTAN=173]="KYRGYZSTAN",J[J.LAOS=174]="LAOS",J[J.LEBANON=175]="LEBANON",J[J.LESOTHO=176]="LESOTHO",J[J.LIBERIA=177]="LIBERIA",J[J.LIBYA=178]="LIBYA",J[J.LIECHTENSTEIN=179]="LIECHTENSTEIN",J[J.MACAU=180]="MACAU",J[J.MADAGASCAR=181]="MADAGASCAR",J[J.MALAWI=182]="MALAWI",J[J.MALI=183]="MALI",J[J.MARSHALL_ISLANDS=184]="MARSHALL_ISLANDS",J[J.MARTINIQUE=185]="MARTINIQUE",J[J.MAURITANIA=186]="MAURITANIA",J[J.MAYOTTE=187]="MAYOTTE",J[J.MOLDOVA=188]="MOLDOVA",J[J.MONACO=189]="MONACO",J[J.MONGOLIA=190]="MONGOLIA",J[J.MONTSERRAT=191]="MONTSERRAT",J[J.MOZAMBIQUE=192]="MOZAMBIQUE",J[J.MYANMAR=193]="MYANMAR",J[J.NAMIBIA=194]="NAMIBIA",J[J.NAURU=195]="NAURU",J[J.NEPAL=196]="NEPAL",J[J.NEW_CALEDONIA=197]="NEW_CALEDONIA",J[J.NIGER=198]="NIGER",J[J.NIUE=199]="NIUE",J[J.NORFOLK_ISLAND=200]="NORFOLK_ISLAND",J[J.NORTHERN_CYPRUS=201]="NORTHERN_CYPRUS",J[J.NORTHERN_MARIANA_ISLANDS=202]="NORTHERN_MARIANA_ISLANDS",J[J.NORTH_KOREA=203]="NORTH_KOREA",J[J.NORTH_MACEDONIA=204]="NORTH_MACEDONIA",J[J.PALAU=205]="PALAU",J[J.PALESTINE=206]="PALESTINE",J[J.PAPUA_NEW_GUINEA=207]="PAPUA_NEW_GUINEA",J[J.PITCAIRN=208]="PITCAIRN",J[J.REUNION=209]="REUNION",J[J.RWANDA=210]="RWANDA",J[J.SAINT_BARTHELEMY=211]="SAINT_BARTHELEMY",J[J.SAINT_HELENA_ASCENSION_AND_TRISTIAN_DA_CUNHA=212]="SAINT_HELENA_ASCENSION_AND_TRISTIAN_DA_CUNHA",J[J.SAINT_KITTS_AND_NEVIS=213]="SAINT_KITTS_AND_NEVIS",J[J.SAINT_LUCIA=214]="SAINT_LUCIA",J[J.SAINT_MARTIN=215]="SAINT_MARTIN",J[J.SAINT_PIERRE_AND_MIQUELON=216]="SAINT_PIERRE_AND_MIQUELON",J[J.SAINT_VINCENT_AND_THE_GRENADINES=217]="SAINT_VINCENT_AND_THE_GRENADINES",J[J.SAMOA=218]="SAMOA",J[J.SAN_MARINO=219]="SAN_MARINO",J[J.SAO_TOME_AND_PRINCIPE=220]="SAO_TOME_AND_PRINCIPE",J[J.SENEGAL=221]="SENEGAL",J[J.SEYCHELLES=222]="SEYCHELLES",J[J.SIERRA_LEONE=223]="SIERRA_LEONE",J[J.SINT_MAARTEN=224]="SINT_MAARTEN",J[J.SOLOMON_ISLANDS=225]="SOLOMON_ISLANDS",J[J.SOMALIA=226]="SOMALIA",J[J.SOUTH_GEORGIA_AND_THE_SOUTH_SANDWICH_ISLANDS=227]="SOUTH_GEORGIA_AND_THE_SOUTH_SANDWICH_ISLANDS",J[J.SOUTH_SUDAN=228]="SOUTH_SUDAN",J[J.SUDAN=229]="SUDAN",J[J.SURINAME=230]="SURINAME",J[J.SVALBARD_AND_JAN_MAYEN=231]="SVALBARD_AND_JAN_MAYEN",J[J.SWAZILAND=232]="SWAZILAND",J[J.SYRIA=233]="SYRIA",J[J.TAJIKISTAN=234]="TAJIKISTAN",J[J.TANZANIA=235]="TANZANIA",J[J.TOGO=236]="TOGO",J[J.TOKELAU=237]="TOKELAU",J[J.TONGA=238]="TONGA",J[J.TRINIDAD_AND_TOBAGO=239]="TRINIDAD_AND_TOBAGO",J[J.TURKMENISTAN=240]="TURKMENISTAN",J[J.TURKS_AND_CAICOS_ISLANDS=241]="TURKS_AND_CAICOS_ISLANDS",J[J.TUVALU=242]="TUVALU",J[J.UNITED_STATES_MINOR_OUTLYING_ISLANDS=243]="UNITED_STATES_MINOR_OUTLYING_ISLANDS",J[J.UZBEKISTAN=244]="UZBEKISTAN",J[J.VANUATU=245]="VANUATU",J[J.VATICAN_CITY=246]="VATICAN_CITY",J[J.VIRGIN_ISLANDS_BRITISH=247]="VIRGIN_ISLANDS_BRITISH",J[J.VIRGIN_ISLANDS_US=248]="VIRGIN_ISLANDS_US",J[J.WALLIS_AND_FUTUNA=249]="WALLIS_AND_FUTUNA",J[J.WESTERN_SAHARA=250]="WESTERN_SAHARA",J[J.YEMEN=251]="YEMEN",J[J.YUGOSLAVIA=252]="YUGOSLAVIA",J[J.ZAMBIA=253]="ZAMBIA",J[J.ZIMBABWE=254]="ZIMBABWE",J[J.COUNT=255]="COUNT",e.Region=void 0,(j=e.Region||(e.Region={}))[j.NONE=0]="NONE",j[j.ALABAMA=1]="ALABAMA",j[j.ALASKA=2]="ALASKA",j[j.ALBERTA=3]="ALBERTA",j[j.ARIZONA=4]="ARIZONA",j[j.ARKANSAS=5]="ARKANSAS",j[j.AUSTRALIAN_CAPITAL_TERRITORY=6]="AUSTRALIAN_CAPITAL_TERRITORY",j[j.BRITISH_COLUMBIA=7]="BRITISH_COLUMBIA",j[j.CALIFORNIA=8]="CALIFORNIA",j[j.COLORADO=9]="COLORADO",j[j.CONNECTICUT=10]="CONNECTICUT",j[j.DELAWARE=11]="DELAWARE",j[j.DISTRICT_OF_COLUMBIA=12]="DISTRICT_OF_COLUMBIA",j[j.FLORIDA=13]="FLORIDA",j[j.GEORGIA=14]="GEORGIA",j[j.HAWAII=15]="HAWAII",j[j.IDAHO=16]="IDAHO",j[j.ILLINOIS=17]="ILLINOIS",j[j.INDIANA=18]="INDIANA",j[j.IOWA=19]="IOWA",j[j.KANSAS=20]="KANSAS",j[j.KENTUCKY=21]="KENTUCKY",j[j.LOUISIANA=22]="LOUISIANA",j[j.MAINE=23]="MAINE",j[j.MANITOBA=24]="MANITOBA",j[j.MARYLAND=25]="MARYLAND",j[j.MASSACHUSETTS=26]="MASSACHUSETTS",j[j.MICHIGAN=27]="MICHIGAN",j[j.MINNESOTA=28]="MINNESOTA",j[j.MISSISSIPPI=29]="MISSISSIPPI",j[j.MISSOURI=30]="MISSOURI",j[j.MONTANA=31]="MONTANA",j[j.NEBRASKA=32]="NEBRASKA",j[j.NEVADA=33]="NEVADA",j[j.NEW_BRUNSWICK=34]="NEW_BRUNSWICK",j[j.NEW_HAMPSHIRE=35]="NEW_HAMPSHIRE",j[j.NEW_JERSEY=36]="NEW_JERSEY",j[j.NEW_MEXICO=37]="NEW_MEXICO",j[j.NEW_SOUTH_WALES=38]="NEW_SOUTH_WALES",j[j.NEW_YORK=39]="NEW_YORK",j[j.NORTHERN_TERRITORY=40]="NORTHERN_TERRITORY",j[j.NORTH_CAROLINA=41]="NORTH_CAROLINA",j[j.NORTH_DAKOTA=42]="NORTH_DAKOTA",j[j.NOVA_SCOTIA=43]="NOVA_SCOTIA",j[j.OHIO=44]="OHIO",j[j.OKLAHOMA=45]="OKLAHOMA",j[j.ONTARIO=46]="ONTARIO",j[j.OREGON=47]="OREGON",j[j.PENNSYLVANIA=48]="PENNSYLVANIA",j[j.QUEBEC=49]="QUEBEC",j[j.QUEENSLAND=50]="QUEENSLAND",j[j.RHODE_ISLAND=51]="RHODE_ISLAND",j[j.SASKATCHEWAN=52]="SASKATCHEWAN",j[j.SOUTH_AUSTRALIA=53]="SOUTH_AUSTRALIA",j[j.SOUTH_CAROLINA=54]="SOUTH_CAROLINA",j[j.SOUTH_DAKOTA=55]="SOUTH_DAKOTA",j[j.TASMANIA=56]="TASMANIA",j[j.TENNESSEE=57]="TENNESSEE",j[j.TEXAS=58]="TEXAS",j[j.UTAH=59]="UTAH",j[j.VERMONT=60]="VERMONT",j[j.VICTORIA=61]="VICTORIA",j[j.VIRGINIA=62]="VIRGINIA",j[j.WASHINGTON=63]="WASHINGTON",j[j.WESTERN_AUSTRALIA=64]="WESTERN_AUSTRALIA",j[j.WEST_VIRGINIA=65]="WEST_VIRGINIA",j[j.WISCONSIN=66]="WISCONSIN",j[j.WYOMING=67]="WYOMING",j[j.YUKON=68]="YUKON",j[j.CIUDAD_DE_MEXICO=69]="CIUDAD_DE_MEXICO",j[j.JALISCO=70]="JALISCO",j[j.NEWFOUNDLAND_AND_LABRADOR=71]="NEWFOUNDLAND_AND_LABRADOR",j[j.NUEVO_LEON=72]="NUEVO_LEON",j[j.BAJA_CALIFORNIA=73]="BAJA_CALIFORNIA",j[j.CHIHUAHUA=74]="CHIHUAHUA",j[j.GUANAJUATO=75]="GUANAJUATO",j[j.GUERRERO=76]="GUERRERO",j[j.MEXICO=77]="MEXICO",j[j.MICHOACAN=78]="MICHOACAN",j[j.NEW_YORK_CITY=79]="NEW_YORK_CITY",j[j.TAMAULIPAS=80]="TAMAULIPAS",j[j.VERACRUZ=81]="VERACRUZ",j[j.CHIAPAS=82]="CHIAPAS",j[j.COAHUILA=83]="COAHUILA",j[j.DURANGO=84]="DURANGO",j[j.GUERRERO_COCULA=85]="GUERRERO_COCULA",j[j.GUERRERO_JUCHITAN=86]="GUERRERO_JUCHITAN",j[j.GUERRERO_TEPECOACUILCO=87]="GUERRERO_TEPECOACUILCO",j[j.GUERRERO_TLACOAPA=88]="GUERRERO_TLACOAPA",j[j.GUJARAT=89]="GUJARAT",j[j.HIDALGO=90]="HIDALGO",j[j.KARNATAKA=91]="KARNATAKA",j[j.KERALA=92]="KERALA",j[j.KHYBER_PAKHTUNKHWA=93]="KHYBER_PAKHTUNKHWA",j[j.MADHYA_PRADESH=94]="MADHYA_PRADESH",j[j.MAHARASHTRA=95]="MAHARASHTRA",j[j.MORELOS=96]="MORELOS",j[j.NAYARIT=97]="NAYARIT",j[j.OAXACA=98]="OAXACA",j[j.PUEBLA=99]="PUEBLA",j[j.PUNJAB=100]="PUNJAB",j[j.QUERETARO=101]="QUERETARO",j[j.SAN_LUIS_POTOSI=102]="SAN_LUIS_POTOSI",j[j.SINALOA=103]="SINALOA",j[j.SONORA=104]="SONORA",j[j.TABASCO=105]="TABASCO",j[j.TAMIL_NADU=106]="TAMIL_NADU",j[j.YUCATAN=107]="YUCATAN",j[j.ZACATECAS=108]="ZACATECAS",j[j.AGUASCALIENTES=109]="AGUASCALIENTES",j[j.BAJA_CALIFORNIA_SUR=110]="BAJA_CALIFORNIA_SUR",j[j.CAMPECHE=111]="CAMPECHE",j[j.COLIMA=112]="COLIMA",j[j.QUINTANA_ROO_BENITO_JUAREZ=113]="QUINTANA_ROO_BENITO_JUAREZ",j[j.COUNT=114]="COUNT",e.DocumentType=void 0,(Z=e.DocumentType||(e.DocumentType={}))[Z.NONE=0]="NONE",Z[Z.CONSULAR_ID=1]="CONSULAR_ID",Z[Z.DL=2]="DL",Z[Z.DL_PUBLIC_SERVICES_CARD=3]="DL_PUBLIC_SERVICES_CARD",Z[Z.EMPLOYMENT_PASS=4]="EMPLOYMENT_PASS",Z[Z.FIN_CARD=5]="FIN_CARD",Z[Z.ID=6]="ID",Z[Z.MULTIPURPOSE_ID=7]="MULTIPURPOSE_ID",Z[Z.MyKad=8]="MyKad",Z[Z.MyKid=9]="MyKid",Z[Z.MyPR=10]="MyPR",Z[Z.MyTentera=11]="MyTentera",Z[Z.PAN_CARD=12]="PAN_CARD",Z[Z.PROFESSIONAL_ID=13]="PROFESSIONAL_ID",Z[Z.PUBLIC_SERVICES_CARD=14]="PUBLIC_SERVICES_CARD",Z[Z.RESIDENCE_PERMIT=15]="RESIDENCE_PERMIT",Z[Z.RESIDENT_ID=16]="RESIDENT_ID",Z[Z.TEMPORARY_RESIDENCE_PERMIT=17]="TEMPORARY_RESIDENCE_PERMIT",Z[Z.VOTER_ID=18]="VOTER_ID",Z[Z.WORK_PERMIT=19]="WORK_PERMIT",Z[Z.iKAD=20]="iKAD",Z[Z.MILITARY_ID=21]="MILITARY_ID",Z[Z.MyKAS=22]="MyKAS",Z[Z.SOCIAL_SECURITY_CARD=23]="SOCIAL_SECURITY_CARD",Z[Z.HEALTH_INSURANCE_CARD=24]="HEALTH_INSURANCE_CARD",Z[Z.PASSPORT=25]="PASSPORT",Z[Z.S_PASS=26]="S_PASS",Z[Z.ADDRESS_CARD=27]="ADDRESS_CARD",Z[Z.ALIEN_ID=28]="ALIEN_ID",Z[Z.ALIEN_PASSPORT=29]="ALIEN_PASSPORT",Z[Z.GREEN_CARD=30]="GREEN_CARD",Z[Z.MINORS_ID=31]="MINORS_ID",Z[Z.POSTAL_ID=32]="POSTAL_ID",Z[Z.PROFESSIONAL_DL=33]="PROFESSIONAL_DL",Z[Z.TAX_ID=34]="TAX_ID",Z[Z.WEAPON_PERMIT=35]="WEAPON_PERMIT",Z[Z.VISA=36]="VISA",Z[Z.BORDER_CROSSING_CARD=37]="BORDER_CROSSING_CARD",Z[Z.DRIVER_CARD=38]="DRIVER_CARD",Z[Z.GLOBAL_ENTRY_CARD=39]="GLOBAL_ENTRY_CARD",Z[Z.MyPolis=40]="MyPolis",Z[Z.NEXUS_CARD=41]="NEXUS_CARD",Z[Z.PASSPORT_CARD=42]="PASSPORT_CARD",Z[Z.PROOF_OF_AGE_CARD=43]="PROOF_OF_AGE_CARD",Z[Z.REFUGEE_ID=44]="REFUGEE_ID",Z[Z.TRIBAL_ID=45]="TRIBAL_ID",Z[Z.VETERAN_ID=46]="VETERAN_ID",Z[Z.CITIZENSHIP_CERTIFICATE=47]="CITIZENSHIP_CERTIFICATE",Z[Z.COUNT=48]="COUNT",e.DocumentImageColorStatus=void 0,(Q=e.DocumentImageColorStatus||(e.DocumentImageColorStatus={}))[Q.NotAvailable=0]="NotAvailable",Q[Q.BlackAndWhite=1]="BlackAndWhite",Q[Q.Color=2]="Color",e.ImageAnalysisDetectionStatus=void 0,(X=e.ImageAnalysisDetectionStatus||(e.ImageAnalysisDetectionStatus={}))[X.NotAvailable=0]="NotAvailable",X[X.NotDetected=1]="NotDetected",X[X.Detected=2]="Detected",e.ProcessingStatus=void 0,(q=e.ProcessingStatus||(e.ProcessingStatus={}))[q.Success=0]="Success",q[q.DetectionFailed=1]="DetectionFailed",q[q.ImagePreprocessingFailed=2]="ImagePreprocessingFailed",q[q.StabilityTestFailed=3]="StabilityTestFailed",q[q.ScanningWrongSide=4]="ScanningWrongSide",q[q.FieldIdentificationFailed=5]="FieldIdentificationFailed",q[q.MandatoryFieldMissing=6]="MandatoryFieldMissing",q[q.InvalidCharactersFound=7]="InvalidCharactersFound",q[q.ImageReturnFailed=8]="ImageReturnFailed",q[q.BarcodeRecognitionFailed=9]="BarcodeRecognitionFailed",q[q.MrzParsingFailed=10]="MrzParsingFailed",q[q.ClassFiltered=11]="ClassFiltered",q[q.UnsupportedClass=12]="UnsupportedClass",q[q.UnsupportedByLicense=13]="UnsupportedByLicense",q[q.AwaitingOtherSide=14]="AwaitingOtherSide",q[q.Count=15]="Count",e.RecognitionMode=void 0,($=e.RecognitionMode||(e.RecognitionMode={}))[$.None=0]="None",$[$.MrzId=1]="MrzId",$[$.MrzVisa=2]="MrzVisa",$[$.MrzPassport=3]="MrzPassport",$[$.PhotoId=4]="PhotoId",$[$.FullRecognition=5]="FullRecognition",$[$.BarcodeId=6]="BarcodeId",$[$.Count=7]="Count";class ne{constructor(){this.enableMrzId=!0,this.enableMrzPassport=!0,this.enableMrzVisa=!0,this.enablePhotoId=!0,this.enableBarcodeId=!0,this.enableFullDocumentRecognition=!0}}class oe{constructor(){this.allowBlurFilter=!0,this.allowUnparsedMrzResults=!1,this.allowUnverifiedMrzResults=!0,this.recognitionModeFilter=new ne,this.scanCroppedDocumentImage=!1,this.validateResultCharacters=!0,this.anonymizationMode=e.AnonymizationMode.FullResult,this.barcodeScanningStartedCallback=null,this.classifierCallback=null,this.allowedDocumentClasses=null,this.paddingEdge=0,this.returnFullDocumentImage=!1,this.returnEncodedFullDocumentImage=!1,this._fullDocumentImageDpi=250,this.fullDocumentImageExtensionFactors=new te,this.returnFaceImage=!1,this.returnEncodedFaceImage=!1,this._faceImageDpi=250,this.returnSignatureImage=!1,this.returnEncodedSignatureImage=!1,this._signatureImageDpi=250}get fullDocumentImageDpi(){return this._fullDocumentImageDpi}set fullDocumentImageDpi(e){ie(e),this._fullDocumentImageDpi=e}get faceImageDpi(){return this._faceImageDpi}set faceImageDpi(e){ie(e),this._faceImageDpi=e}get signatureImageDpi(){return this._signatureImageDpi}set signatureImageDpi(e){ie(e),this._signatureImageDpi=e}}e.IdBarcodeDocumentType=void 0,(ee=e.IdBarcodeDocumentType||(e.IdBarcodeDocumentType={}))[ee.None=0]="None",ee[ee.AAMVACompliant=1]="AAMVACompliant",ee[ee.ArgentinaID=2]="ArgentinaID",ee[ee.ArgentinaDL=3]="ArgentinaDL",ee[ee.ColombiaID=4]="ColombiaID",ee[ee.ColombiaDL=5]="ColombiaDL",ee[ee.NigeriaVoterID=6]="NigeriaVoterID",ee[ee.NigeriaDL=7]="NigeriaDL",ee[ee.PanamaID=8]="PanamaID",ee[ee.SouthAfricaID=9]="SouthAfricaID",e.BlinkIdCombinedRecognizerSettings=class extends oe{constructor(){super(...arguments),this.allowUncertainFrontSideScan=!1,this.maxAllowedMismatchesPerField=0,this.allowSignature=!1}},e.BlinkIdRecognizerSettings=oe,e.CapturedFrame=H,e.ExtensionFactors=te,e.IdBarcodeRecognizerSettings=class{},e.RecognitionModeFilter=ne,e.VideoRecognizer=G,e.VideoRecognizerError=W,e.WasmSDKLoadSettings=class{constructor(e){if(this.allowHelloMessage=!0,this.engineLocation="",this.wasmType=null,this.numberOfWorkers=null,this.loadProgressCallback=null,this.wasmModuleName="BlinkIDWasmSDK",!e)throw Error("Missing license key!");this.licenseKey=e}},e.captureFrame=F,e.createBlinkIdCombinedRecognizer=function(e){return t(this,void 0,void 0,(function*(){return e.mbWasmModule.newRecognizer("BlinkIdCombinedRecognizer")}))},e.createBlinkIdRecognizer=function(e){return t(this,void 0,void 0,(function*(){return e.mbWasmModule.newRecognizer("BlinkIdRecognizer")}))},e.createIdBarcodeRecognizer=function(e){return t(this,void 0,void 0,(function*(){return e.mbWasmModule.newRecognizer("IdBarcodeRecognizer")}))},e.createRecognizerRunner=function(e,i,n=!1,o={}){return t(this,void 0,void 0,(function*(){if("object"!=typeof e)throw Error("SDK is not provided!");if("object"!=typeof i||1>i.length)throw Error("To create RecognizerRunner at least 1 recognizer is required.");return e.mbWasmModule.createRecognizerRunner(i,n,o)}))},e.createSuccessFrameGrabberRecognizer=function(e,i){return t(this,void 0,void 0,(function*(){const t=yield e.mbWasmModule.newRecognizer("SuccessFrameGrabberRecognizer",i);return t.wrappedRecognizer=i,t}))},e.detectWasmType=function(i){return t(this,void 0,void 0,(function*(){const t=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])))(),n=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,12,1,10,0,67,0,0,0,0,252,0,26,11])))(),o=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,65,0,192,26,11])))(),a=yield(async e=>{try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));if(!(t&&n&&o))return e.WasmType.Basic;if(!a)return e.WasmType.Advanced;try{return new Worker(i+"/Worker.test.js").terminate(),e.WasmType.AdvancedWithThreads}catch(t){return e.WasmType.Advanced}}))},e.isBrowserSupported=function(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){const e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(e){return!1}return!1},e.loadWasmModule=function(e){return t(this,void 0,void 0,(function*(){return new Promise((t,i)=>{if(!e||"object"!=typeof e)return void i("Missing WASM load settings!");if("string"!=typeof e.licenseKey)return void i("Missing license key!");if(!e.wasmModuleName)return void i("Missing WASM module name!");if("string"!=typeof e.engineLocation)return void i("Setting property 'engineLocation' must be a string!");const n=function(){try{let e=localStorage.getItem("mb-user-id");return null===e&&(e=V(),localStorage.setItem("mb-user-id",e)),e}catch(e){return V()}}();try{const o=new Blob([String.raw`!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function e(e,t,s,r){return new(s||(s=Promise))((function(n,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}let t=0;class s{constructor(e){this.action=e,this.messageID=function(){const e=t;return t+=1,e}()}}class r extends s{constructor(e,t){super(r.action),this.wasmModuleName=e.wasmModuleName,this.licenseKey=e.licenseKey,this.userId=t,this.registerLoadCallback=null!==e.loadProgressCallback,this.allowHelloMessage=e.allowHelloMessage,this.engineLocation=e.engineLocation,this.wasmType=e.wasmType,this.numberOfWorkers=e.numberOfWorkers}}var n,i;r.action="init",function(e){e[e.Any=0]="Any",e[e.Recognizer=1]="Recognizer",e[e.RecognizerSettings=2]="RecognizerSettings",e[e.Callback=3]="Callback"}(n||(n={}));class o extends s{constructor(e,t){super(o.action),this.funcName=e,this.params=t}}o.action="invokeFunction";class a extends s{constructor(e,t){super(a.action),this.className=e,this.params=t}}a.action="createNewNativeObject";class c extends s{constructor(e,t,s){super(c.action),this.recognizerHandles=e,this.allowMultipleResults=t,this.registeredMetadataCallbacks=s}}c.action="createRecognizerRunner";class l extends s{constructor(e,t){super(l.action),this.recognizerHandles=e,this.allowMultipleResults=t}}l.action="reconfigureRecognizerRunner";class u extends s{constructor(){super(u.action)}}u.action="deleteRecognizerRunner";class h extends s{constructor(e,t,s){super(h.action),this.objectHandle=e,this.methodName=t,this.params=s}}h.action="invokeObject";class d extends s{constructor(e){super(d.action),this.frame=e}getTransferrables(){return[this.frame.imageData.data.buffer]}}d.action="processImage";class g extends s{constructor(e){super(g.action),this.hardReset=e}}g.action="resetRecognizers";class m extends s{constructor(e){super(m.action),this.registeredMetadataCallbacks=e}}m.action="registerMetadataCallbacks";class f extends s{constructor(e){super(f.action),this.detectionOnlyMode=e}}f.action="setDetectionOnly";class y extends s{constructor(e){super(y.action),this.callbackNonEmpty=e}}y.action="setClearTimeoutCallback";class p extends s{constructor(e){super(p.action),this.cameraPreviewMirrored=e}}p.action="setCameraPreviewMirrored";class b{constructor(e,t,s){this.success=!0,this.error=null,this.messageID=e,this.success=t,this.error=s}}class R{constructor(e,t,s,r){this.success=!0,this.showOverlay=!0,this.messageID=e,this.showOverlay=s,this.wasmType=r}}class k extends b{constructor(e,t){super(e,!0,null),this.result=t}}class w extends b{constructor(e,t){super(e,!0,null),this.objectHandle=t}}class v extends b{constructor(e,t){super(e,!0,null),this.recognitionState=t}}class C{constructor(e){this.isLoadProgressMessage=!0,this.progress=e}}!function(e){e[e.onDebugText=0]="onDebugText",e[e.onDetectionFailed=1]="onDetectionFailed",e[e.onQuadDetection=2]="onQuadDetection",e[e.onPointsDetection=3]="onPointsDetection",e[e.onFirstSideResult=4]="onFirstSideResult",e[e.clearTimeoutCallback=5]="clearTimeoutCallback",e[e.onGlare=6]="onGlare",e[e.recognizerCallback=7]="recognizerCallback"}(i||(i={}));class E{constructor(e,t){this.isCallbackMessage=!0,this.callbackType=e,this.callbackParameters=t}}function z(e,t){return t=t||"",""===(e=e||"")?t:e.endsWith("/")?t.startsWith("/")?e+t.substring(1):e+t:t.startsWith("/")?e+t:e+"/"+t}var M,T,S;function I(t){return e(this,void 0,void 0,(function*(){const e=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])))(),s=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,12,1,10,0,67,0,0,0,0,252,0,26,11])))(),r=yield(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,65,0,192,26,11])))(),n=yield(async e=>{try{return"undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));if(!(e&&s&&r))return M.Basic;if(!n)return M.Advanced;try{return new Worker(t+"/Worker.test.js").terminate(),M.AdvancedWithThreads}catch(e){return M.Advanced}}))}!function(e){e.Basic="BASIC",e.Advanced="ADVANCED",e.AdvancedWithThreads="ADVANCED_WITH_THREADS"}(M||(M={})),function(e){e[e.Invalid=0]="Invalid",e[e.RequiresServerPermission=1]="RequiresServerPermission",e[e.Valid=2]="Valid"}(T||(T={})),function(e){e.LicenseTokenStateInvalid="LICENSE_TOKEN_STATE_INVALID",e.NetworkError="NETWORK_ERROR",e.RemoteLock="REMOTE_LOCK",e.PermissionExpired="PERMISSION_EXPIRED",e.PayloadCorrupted="PAYLOAD_CORRUPTED",e.PayloadSignatureVerificationFailed="PAYLOAD_SIGNATURE_VERIFICATION_FAILED",e.IncorrectTokenState="INCORRECT_TOKEN_STATE"}(S||(S={}));class x{constructor(e,t){this.code="UNLOCK_LICENSE_ERROR",this.message=null,this.type=e,t&&(this.message=t)}}function D(e){return{licenseId:e.licenseId,licensee:e.licensee,packageName:e.packageName,platform:"Browser",sdkName:e.sdkName,sdkVersion:e.sdkVersion}}var P;function O(t,s){return e(this,void 0,void 0,(function*(){try{const e=yield fetch("https://baltazar.microblink.com/api/v1/status/check",{method:"POST",headers:{"Content-Type":"application/json"},cache:"no-cache",body:JSON.stringify(D(t))});if(e.ok){const t=""+(yield e.text());return s.submitServerPermission(t)}return{status:P.NetworkError,lease:0,networkErrorDescription:"Server responded with status "+e.status}}catch(e){return{status:P.NetworkError,lease:0,networkErrorDescription:"Unexpected error: "+JSON.stringify(e)}}}))}function N(e){return e===M.AdvancedWithThreads}!function(e){e[e.Ok=0]="Ok",e[e.NetworkError=1]="NetworkError",e[e.RemoteLock=2]="RemoteLock",e[e.PermissionExpired=3]="PermissionExpired",e[e.PayloadCorrupted=4]="PayloadCorrupted",e[e.PayloadSignatureVerificationFailed=5]="PayloadSignatureVerificationFailed",e[e.IncorrectTokenState=6]="IncorrectTokenState"}(P||(P={}));new class{constructor(){this.context=self,this.wasmModule=null,this.nativeRecognizerRunner=null,this.objects={},this.nextObjectHandle=0,this.metadataCallbacks={},this.clearTimeoutCallback=null,this.context.onmessage=e=>{const t=e.data;switch(t.action){case r.action:this.processInitMessage(t);break;case o.action:this.processInvokeFunction(t);break;case a.action:this.processCreateNewRecognizer(t);break;case h.action:this.processInvokeObject(t);break;case c.action:this.processCreateRecognizerRunner(t);break;case l.action:this.processReconfigureRecognizerRunner(t);break;case u.action:this.processDeleteRecognizerRunner(t);break;case d.action:this.processImage(t);break;case g.action:this.resetRecognizers(t);break;case f.action:this.setDetectionOnly(t);break;case p.action:this.setCameraPreviewMirrored(t);break;case m.action:this.registerMetadataCallbacks(t);break;case y.action:this.registerClearTimeoutCallback(t);break;default:throw Error("Unknown message action: "+JSON.stringify(t.action))}}}getNextObjectHandle(){const e=this.nextObjectHandle;return this.nextObjectHandle=this.nextObjectHandle+1,e}notifyError(e,t){this.context.postMessage(new b(e.messageID,!1,t))}notifySuccess(e){this.context.postMessage(new b(e.messageID,!0,null))}notifyInitSuccess(e,t,s){this.context.postMessage(new R(e.messageID,!0,t,s))}unwrapParameters(e){const t=[];for(const s of e.params){let r=s.parameter;s.type===n.Recognizer?(r=this.objects[r],void 0===r&&this.notifyError(e,"Cannot find object with handle: undefined")):s.type===n.RecognizerSettings&&(r=this.restoreFunctions(r)),t.push(r)}return t}restoreFunctions(e){const t=Object.keys(e);for(const s of t){const t=e[s];"object"==typeof t&&null!==t&&"parameter"in t&&"type"in t&&t.type===n.Callback&&(e[s]=(...e)=>{const s=new E(i.recognizerCallback,[t.parameter].concat(e));this.context.postMessage(s)})}return e}scanForTransferrables(e){if("object"==typeof e){const t=Object.keys(e),s=[];for(const r of t){const t=e[r];t instanceof ImageData?s.push(t.data.buffer):t instanceof Uint8Array?s.push(t.buffer):null!==t&&"object"==typeof t&&s.push(...this.scanForTransferrables(t))}return s}return[]}registerHeartBeat(e){this.unregisterHeartBeat(),this.lease=e;let t=e-Math.floor(Date.now()/1e3);t>120?t-=120:t/=2,this.inFlightHeartBeatTimeoutId=setTimeout(()=>{this.obtainNewServerPermission(!0)},1e3*t)}unregisterHeartBeat(){this.lease&&delete this.lease,this.inFlightHeartBeatTimeoutId&&(clearTimeout(this.inFlightHeartBeatTimeoutId),delete this.inFlightHeartBeatTimeoutId)}obtainNewServerPermission(t){return e(this,void 0,void 0,(function*(){if(this.wasmModule){const e=this.wasmModule.getActiveLicenseTokenInfo(),s=yield O(e,this.wasmModule);switch(s.status){case P.Ok:case P.RemoteLock:this.registerHeartBeat(s.lease);break;case P.NetworkError:case P.PayloadSignatureVerificationFailed:case P.PayloadCorrupted:t?(console.warn("Problem with obtaining server permission. Will attempt in 10 seconds "+P[s.status]),this.inFlightHeartBeatTimeoutId=setTimeout(()=>{this.obtainNewServerPermission(!1)},1e4)):console.error("Problem with obtaining server permission. "+P[s.status]);break;case P.IncorrectTokenState:case P.PermissionExpired:console.error("Internal error: "+P[s.status])}return s.status}return console.error("Internal inconsistency! Wasm module not initialized where it's expected to be!"),P.IncorrectTokenState}))}willSoonExpire(){if(this.lease){if(this.wasmModule.getActiveLicenseTokenInfo().unlockResult===T.Valid){const e=Math.floor(Date.now()/1e3);return 30>this.lease-e}return!0}return!1}calculateWasmType(t){return e(this,void 0,void 0,(function*(){return null!==t.wasmType?t.wasmType:yield I(t.engineLocation)}))}calculateEngineLocationPrefix(e,t){const s=z(""===e.engineLocation?self.location.origin:e.engineLocation,function(e){switch(e){case M.AdvancedWithThreads:return"advanced-threads";case M.Advanced:return"advanced";case M.Basic:return"basic"}}(t));return e.allowHelloMessage&&console.log("Engine location prefix is:",s),s}processInitMessage(t){return e(this,void 0,void 0,(function*(){const s=yield this.calculateWasmType(t),r=this.calculateEngineLocationPrefix(t,s);let n={locateFile:e=>z(r,e)};t.registerLoadCallback&&(n=Object.assign(n,{setStatus:e=>{const t=new C(function(e){if("Running..."===e)return 100;if(0===e.length)return 0;const t=/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/.exec(e);if(t){return 100*parseInt(t[2])/parseInt(t[4])}return NaN}(e));this.context.postMessage(t)}}));try{const i=z(r,t.wasmModuleName+".js");N(s)&&(n=function(e,t,s){return t&&t>0&&(e=Object.assign(e,{allowedThreads:t})),null!==s&&(e=Object.assign(e,{mainScriptUrlOrBlob:s})),e}(n,t.numberOfWorkers,i)),importScripts(i);(0,self[t.wasmModuleName])(n).then(r=>e(this,void 0,void 0,(function*(){N(s)&&(t.allowHelloMessage&&console.log("Waiting for thread workers to boot..."),yield function(t){return e(this,void 0,void 0,(function*(){t.threadWorkersReadyPromise&&(yield t.threadWorkersReadyPromise)}))}(r));const n=yield function(t,s,r,n){return e(this,void 0,void 0,(function*(){const e=n.initializeWithLicenseKey(t,r,s);switch(e.unlockResult){case T.Invalid:return{error:new x(S.LicenseTokenStateInvalid,e.licenseError)};case T.Valid:return{error:null,showOverlay:(i=e.isTrial,o=e.allowRemoveDemoOverlay,a=e.allowRemoveProductionOverlay,!(i&&o||!i&&a))};case T.RequiresServerPermission:{const t=yield O(e,n);switch(t.status){case P.Ok:return{error:null,lease:t.lease};case P.NetworkError:{let e="";return t.networkErrorDescription&&(e=" "+t.networkErrorDescription),{error:new x(S.NetworkError,"There has been a network error while obtaining the server permission!"+e)}}case P.RemoteLock:return{error:new x(S.RemoteLock,"Provided license key has been remotely locked.Please contact support for more information!"),lease:t.lease};case P.PermissionExpired:return{error:new x(S.PermissionExpired,"Internal error (server permission expired)"),lease:t.lease};case P.PayloadCorrupted:return{error:new x(S.PayloadCorrupted,"Server permission payload is corrupted!"),lease:t.lease};case P.PayloadSignatureVerificationFailed:return{error:new x(S.PayloadSignatureVerificationFailed,"Failed to verify server permission's digital signature!"),lease:t.lease};case P.IncorrectTokenState:return{error:new x(S.IncorrectTokenState,"Internal error (Incorrect token state)"),lease:t.lease}}}}var i,o,a}))}(t.licenseKey,t.allowHelloMessage,t.userId,r);null===n.error?(this.wasmModule=r,n.lease?this.registerHeartBeat(n.lease):this.unregisterHeartBeat(),this.notifyInitSuccess(t,!!n.showOverlay,s)):this.notifyError(t,n.error)})),e=>{this.notifyError(t,e)})}catch(e){this.notifyError(t,e)}}))}processInvokeFunction(e){if(null===this.wasmModule)return void this.notifyError(e,"WASM module is not initialized!");const t=e.funcName,s=this.unwrapParameters(e);try{const r=this.wasmModule[t](...s);this.context.postMessage(new k(e.messageID,r))}catch(t){this.notifyError(e,t)}}processCreateNewRecognizer(e){if(null===this.wasmModule)return void this.notifyError(e,"WASM module is not initialized!");const t=e.className,s=this.unwrapParameters(e);try{const r=new this.wasmModule[t](...s),n=this.getNextObjectHandle();this.objects[n]=r,this.context.postMessage(new w(e.messageID,n))}catch(t){this.notifyError(e,t)}}getRecognizers(e){const t=[];for(const s of e){t.push(this.objects[s])}return t}processCreateRecognizerRunner(t){return e(this,void 0,void 0,(function*(){if(null===this.wasmModule)this.notifyError(t,"WASM module is not initialized!");else if(null!==this.nativeRecognizerRunner)this.notifyError(t,"Recognizer runner is already created! Multiple instances are not allowed!");else{this.setupMetadataCallbacks(t.registeredMetadataCallbacks);try{if(this.willSoonExpire()){const e=yield this.obtainNewServerPermission(!1);if(e!==P.Ok){const s=P[e];return void this.notifyError(t,new x(S[s],"Cannot initialize recognizers because of invalid server permission: "+s))}}const e=this.getRecognizers(t.recognizerHandles);this.nativeRecognizerRunner=new this.wasmModule.RecognizerRunner(e,t.allowMultipleResults,this.metadataCallbacks),this.notifySuccess(t)}catch(e){this.notifyError(t,e)}}}))}processReconfigureRecognizerRunner(e){if(null===this.wasmModule)this.notifyError(e,"WASM module is not initialized!");else if(null===this.nativeRecognizerRunner)this.notifyError(e,"Recognizer runner is not created! There is nothing to reconfigure!");else try{const t=this.getRecognizers(e.recognizerHandles);this.nativeRecognizerRunner.reconfigureRecognizers(t,e.allowMultipleResults),this.notifySuccess(e)}catch(t){this.notifyError(e,t)}}processDeleteRecognizerRunner(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.delete(),this.nativeRecognizerRunner=null,this.notifySuccess(e)}catch(t){this.notifyError(e,t)}else this.notifyError(e,"Recognizer runner is already deleted!")}processInvokeObject(e){try{const t=e.objectHandle,s=e.methodName,r=this.unwrapParameters(e),n=this.objects[t];if(void 0===n)this.notifyError(e,"Cannot find object with handle: "+t);else{const i=n[s](...r),o=this.scanForTransferrables(i);"delete"===s&&delete this.objects[t],this.context.postMessage(new k(e.messageID,i),o)}}catch(t){this.notifyError(e,t)}}processImage(e){if(null!==this.nativeRecognizerRunner)try{const t=this.nativeRecognizerRunner.processImage(e.frame);this.context.postMessage(new v(e.messageID,t))}catch(t){this.notifyError(e,t)}else this.notifyError(e,"Recognizer runner is not initialized! Cannot process image!")}resetRecognizers(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.resetRecognizers(e.hardReset),this.notifySuccess(e)}catch(t){this.notifyError(e,t)}else this.notifyError(e,"Recognizer runner is not initialized! Cannot process image!")}setDetectionOnly(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.setDetectionOnlyMode(e.detectionOnlyMode),this.notifySuccess(e)}catch(t){this.notifyError(e,t)}else this.notifyError(e,"Recognizer runner is not initialized! Cannot process image!")}setCameraPreviewMirrored(e){if(null!==this.nativeRecognizerRunner)try{this.nativeRecognizerRunner.setCameraPreviewMirrored(e.cameraPreviewMirrored),this.notifySuccess(e)}catch(t){this.notifyError(e,t)}else this.notifyError(e,"Recognizer runner is not initialized! Cannot process image!")}setupMetadataCallbacks(e){e.onDebugText?this.metadataCallbacks.onDebugText=e=>{const t=new E(i.onDebugText,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onDebugText,e.onDetectionFailed?this.metadataCallbacks.onDetectionFailed=()=>{const e=new E(i.onDetectionFailed,[]);this.context.postMessage(e)}:delete this.metadataCallbacks.onDetectionFailed,e.onPointsDetection?this.metadataCallbacks.onPointsDetection=e=>{const t=new E(i.onPointsDetection,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onPointsDetection,e.onQuadDetection?this.metadataCallbacks.onQuadDetection=e=>{const t=new E(i.onQuadDetection,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onQuadDetection,e.onFirstSideResult?this.metadataCallbacks.onFirstSideResult=()=>{const e=new E(i.onFirstSideResult,[]);this.context.postMessage(e)}:delete this.metadataCallbacks.onFirstSideResult,e.onGlare?this.metadataCallbacks.onGlare=e=>{const t=new E(i.onGlare,[e]);this.context.postMessage(t)}:delete this.metadataCallbacks.onGlare}registerMetadataCallbacks(e){if(null!==this.nativeRecognizerRunner){this.setupMetadataCallbacks(e.registeredMetadataCallbacks);try{this.nativeRecognizerRunner.setJSDelegate(this.metadataCallbacks),this.notifySuccess(e)}catch(t){this.notifyError(e,t)}}else this.notifyError(e,"Recognizer runner is not initialized! Cannot process image!")}registerClearTimeoutCallback(e){if(null!==this.nativeRecognizerRunner){this.clearTimeoutCallback=e.callbackNonEmpty?{onClearTimeout:()=>{const e=new E(i.clearTimeoutCallback,[]);this.context.postMessage(e)}}:null;try{this.nativeRecognizerRunner.setClearTimeoutCallback(this.clearTimeoutCallback),this.notifySuccess(e)}catch(t){this.notifyError(e,t)}}else this.notifyError(e,"Recognizer runner is not initialized! Cannot process image!")}}}();
`],{type:"application/javascript"}),a=URL.createObjectURL(o),r=new Worker(a);b.createWasmWorker(r,e,n).then(e=>{t(e)},i)}catch(e){i(e)}})}))},e.validateDpi=ie,e.wasmFolder=function(t){switch(t){case e.WasmType.AdvancedWithThreads:return"advanced-threads";case e.WasmType.Advanced:return"advanced";case e.WasmType.Basic:return"basic"}},Object.defineProperty(e,"__esModule",{value:!0})}));
